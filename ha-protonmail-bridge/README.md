# Home Assistant Add-on: ProtonMail Bridge v3

Run the official ProtonMail Bridge v3.x as a Home Assistant add-on, enabling SMTP and IMAP access to your ProtonMail account from Home Assistant.

![Supports amd64 Architecture][amd64-shield]
![Supports aarch64 Architecture][aarch64-shield]

[amd64-shield]: https://img.shields.io/badge/amd64-yes-green.svg
[aarch64-shield]: https://img.shields.io/badge/aarch64-yes-green.svg

## About

This add-on runs the official [ProtonMail Bridge](https://github.com/ProtonMail/proton-bridge) v3.x binary inside a Docker container. It exposes SMTP (port 25 → internal 1025) and IMAP (port 143 → internal 1143) so you can send emails from Home Assistant using your ProtonMail account.

> **Note:** This is a fork of [fboulay/ha-addons-repository](https://github.com/fboulay/ha-addons-repository), updated to support ProtonMail Bridge v3.x which uses a gRPC API instead of the old interactive CLI.

## Supported Architectures

- **amd64**: Uses the official pre-built `.deb` binary from the ProtonMail Bridge releases.
- **aarch64**: Built from source (Go) during Docker build.

## Installation

1. Add this repository to your Home Assistant Add-on Store:
   ```
   https://github.com/merlindegrote/ha-protonmail-bridge-v3
   ```
2. Install the **ProtonMail Bridge v3** add-on.
3. Configure your ProtonMail credentials (username and password) in the add-on configuration.
4. Start the add-on.

## Configuration

```yaml
username: your@protonmail.com
password: your_protonmail_password
```

| Option | Required | Description |
|--------|----------|-------------|
| `username` | Yes | Your ProtonMail account email address |
| `password` | Yes | Your ProtonMail account password |

## Ports

| Port | Description |
|------|-------------|
| 25/tcp | SMTP port (Bridge forwards to internal port 1025) |
| 143/tcp | IMAP port (Bridge forwards to internal port 1143) |

## Home Assistant Email Configuration

Use these settings in your Home Assistant `configuration.yaml`:

```yaml
smtp:
  server: localhost
  port: 25
  sender: your@protonmail.com
  username: your@protonmail.com
  password: !secret protonmail_bridge_password
```

The SMTP password is the **Bridge password** generated by ProtonMail Bridge (not your ProtonMail account password). Check the add-on logs after first start to find the Bridge SMTP/IMAP credentials.

## How It Works

- On first start, the Bridge will attempt to log in using the credentials from the add-on configuration via the gRPC API.
- The vault (credentials) is stored persistently in `/data`.
- Subsequent starts will reuse the stored credentials without requiring re-authentication.

## Changelog

See [CHANGELOG.md](CHANGELOG.md) for version history.
